---
import { TECHNIQUE_LABELS, type Nade } from '../lib/nades';

interface Props {
  nade: Nade;
  idx: number;
  bookmarked?: boolean;
}

const { nade, idx, bookmarked = false } = Astro.props;
const title = `${nade.titleTo} from ${nade.titleFrom}`;
const sideLabel = nade.team === 't' ? 'T' : 'CT';
const technique = TECHNIQUE_LABELS[nade.technique] || nade.technique;

const frameBase = `data/${nade.map}/${nade.slug}`;
---

<div
  class={`nade-card${bookmarked ? ' bookmarked-card' : ''}`}
  data-map={nade.map}
  data-side={nade.team}
  data-idx={idx}
  data-slug={nade.slug}
>
  <img
    class="card-img"
    src={`${frameBase}/result.jpg`}
    alt={title}
    loading="lazy"
  />
  <video
    class="card-video"
    src={`${frameBase}/result_thumb.mp4`}
    muted
    loop
    playsinline
    preload="none"
  ></video>
  <div class="card-overlay">
    <span class={`tag map-${nade.map}`}>{nade.map}</span>
    <span class={`tag side-${nade.team}`}>{sideLabel}</span>
  </div>
  <button
    class={`bookmark-btn${bookmarked ? ' bookmarked' : ''}`}
    data-slug={nade.slug}
    title="Bookmark"
  >
    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
    </svg>
  </button>
  <div class="card-label">
    <span class="card-title">{title}</span>
    <span class="card-tech">{technique}</span>
  </div>
</div>
